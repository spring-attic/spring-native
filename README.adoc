:version: 0.8.2
:repository: milestone
:boot-version: 2.4.0-RC1
:graalvm-version: 20.2.0
:graalvm-dev-version: 20.3.0-dev
:boot-dev-version: 2.4.0
:documentation-url: https://repo.spring.io/{repository}/org/springframework/experimental/spring-graalvm-native-docs/{version}/spring-graalvm-native-docs-{version}.zip!

image:https://img.shields.io/badge/{version}-documentation-blue.svg["{version} documentation", link="{documentation-url}/reference/index.html"]

This project goal is to incubate support for building https://spring.io/projects/spring-boot[Spring Boot] applications as https://www.graalvm.org/docs/reference-manual/native-image/[GraalVM native images].

Watch https://www.youtube.com/watch?v=Um9djPTtPe0[The Path Towards Spring Boot Native Applications] SpringOne 2020 talk recording for more details:
image:https://img.youtube.com/vi/Um9djPTtPe0/maxresdefault.jpg["The Path Towards Spring Boot Native Applications",align="center", width=640px, link="https://www.youtube.com/watch?v=Um9djPTtPe0"]

It is mainly composed of:

- `spring-graalvm-native-feature`: this module is a https://www.graalvm.org/sdk/javadoc/org/graalvm/nativeimage/hosted/Feature.html[GraalVM feature]. It is a kind of plugin for the native-image compilation process (which creates the native-image from the built class files). The feature participates in the compilation lifecycle, being invoked at different compilation stages to offer extra information about the application to aid in the image construction.
- `spring-graalvm-native-configuration`: this module contains configuration hints for Spring classes, including various Spring Boot auto-configurations.
- `spring-graalvm-native-substitutions`: this module allows us to patch temporarily some part of Spring Boot and Spring Framework to improve compatibility and efficiency of Spring native images.
- `spring-graalvm-native`: this module aggregates the feature, configuration, and substitutions ones to generate the artifact to consume.
- `spring-graalvm-native-samples`: contains various samples that demonstrate the feature usage and are used as integration tests.
- `spring-graalvm-native-docs`: contains the asciidoc documentation sources.
- `spring-graalvm-native-tools`: tools used for reviewing image building configuration and output.

It supports the {documentation-url}/reference/index.html#_spring_graalvm_native_options[following modes] using `-Dspring.native.mode=<mode>` on the `native-image` command line:

- `reflection` (activated by default) provides resource, initialization, proxy, and reflection (using auto-configuration hints) configuration for native images as well as substitutions.
- `init` (manually activated) should be used if only wishing to provide initialization configuration and substitutions.
- `agent` (activated when the agent-generated config is present) is using the configuration generated by the tracing agent as a basis and also provides additional hints for components like controllers, etc.
- `functional` (activated when (https://github.com/spring-projects-experimental/spring-fu[spring-fu] or https://github.com/spring-projects-experimental/spring-init/[spring-init] are in the classpath) is designed to work with functional bean registration. In this mode, the feature will provide initialization, resource configuration, substitutions, and `spring.factories` functional alternative (only Spring Boot `spring.factories` are supported for now).

== Scope and status

This project status is alpha, which means that we are currently mainly working on the software design and on supporting the features of the current samples (work in progress).
Supporting a wider range of Spring Boot applications, as well as optimizing efficiency (image size, memory consumption) and performances will happen as a second step.

Spring team collaborates with the GraalVM native team by raising issues in their bug tracker, to improve the production-readiness of native-images. These bugs on the GraalVM issue tracker https://github.com/oracle/graal/labels/spring[are identified by the `spring` label].

Some changes incubated here are moved directly to https://github.com/spring-projects/spring-framework/labels/type%3A%20native[Spring Framework] and https://github.com/spring-projects/spring-boot/labels/theme%3A%20native[Spring Boot] projects.

== Quick start

For detailed information and walkthroughs of applying the techniques to your project, please see the {documentation-url}/reference/index.html[documentation].

=== Artifacts

The latest {version} release supports GraalVM {graalvm-version} and Spring Boot {boot-version}.

- Artifact: https://repo.spring.io/{repository}/org/springframework/experimental/spring-graalvm-native/{version}/spring-graalvm-native-{version}.jar[`org.springframework.experimental:spring-graalvm-native:{version}`]
- Repository: https://repo.spring.io/{repository}[`https://repo.spring.io/{repository}`]

=== Play with the samples

- Download and extract https://github.com/spring-projects-experimental/spring-graalvm-native/archive/{version}.zip[sources from the latest release].
- Go into the samples folder and pick one (e.g. `cd spring-graalvm-native-samples/commandlinerunner`)
- Run `./build.sh` which will run a maven build, then a native image compile, then test the result.

`build.sh` runs the `compile.sh` script and in that compile script you can see the invocation of the `native-image` command. The other samples follow a similar model. For more details on the samples see the {documentation-url}/reference/index.html#samples[samples documentation].

== Contributing

This project is in the `spring-projects-experimental` org indicating it is not as mature as other Spring projects. Contributions are welcome (maybe read the {documentation-url}/reference/index.html#extension_guide[extension guide] if thinking about extending it to support your project). However, please recognize we aren't at the polishing javadoc stage and whilst pre 1.0 there may be heavy evolution of APIs.

=== Baseline

The development version on `master` is currently based on GraalVM {graalvm-dev-version} and Spring Boot {boot-dev-version}.
Mac and Linux are supported, Windows is untested.

== License

https://www.apache.org/licenses/LICENSE-2.0[Apache License v2.0]
